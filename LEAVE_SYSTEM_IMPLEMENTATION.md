# نظام الإجازات والاستئذانات - Flutter RTL

## نظرة عامة

تم إنشاء نظام شامل لإدارة الإجازات والاستئذانات في التطبيق مع دعم كامل للغة العربية واتجاه RTL. النظام يتبع تصميم Material 3 ويستخدم خط Cairo للنصوص العربية.

## الميزات الرئيسية

### 1. رصيد الإجازات المتاح
- عرض رصيد الإجازات السنوية والمرضية والطارئة
- بطاقات ملونة بألوان مميزة لكل نوع إجازة
- عرض المتبقي من إجمالي الأيام المسموحة

### 2. طلب الإجازات والاستئذانات
- نموذج موحد مع تبويبات منفصلة
- طلب إجازة: نوع الإجازة، تاريخ البداية والنهاية، السبب
- طلب استئذان: نوع الاستئذان، التاريخ، من وإلى، السبب
- حساب تلقائي لمدة الاستئذان
- تحققات شاملة مع رسائل خطأ باللغة العربية

### 3. تاريخ الطلبات
- عرض تاريخ الإجازات مع الحالات (موافق عليها، قيد المراجعة، مرفوضة)
- عرض تاريخ الاستئذانات مع التفاصيل الكاملة
- دعم الحالات الفارغة مع رسائل مناسبة

## البنية التقنية

### الموديلات (Models)
```
lib/Data/Models/leave_models.dart
```
- `LeaveType`: أنواع الإجازات (سنوية، مرضية، طارئة)
- `PermissionType`: أنواع الاستئذان (خروج مبكر، تأخير، ساعات ضمن الدوام)
- `RequestStatus`: حالات الطلبات (موافق عليها، قيد المراجعة، مرفوضة)
- `LeaveBalance`: رصيد الإجازات
- `LeaveRequest`: طلب إجازة
- `PermissionRequest`: طلب استئذان
- `LeaveRecord`: سجل إجازة
- `PermissionRecord`: سجل استئذان

### إدارة الحالة (Bloc)
```
lib/Bloc/leave/
├── leave_bloc.dart
├── leave_event.dart
└── leave_state.dart
```

### واجهة المستخدم
```
lib/Ui/Leave/
├── leave_management_page.dart
└── _widgets/
    ├── leave_balance_section.dart
    ├── leave_balance_card.dart
    ├── leave_request_form.dart
    ├── leave_history_section.dart
    ├── leave_history_item.dart
    ├── permission_history_section.dart
    └── permission_history_item.dart
```

## التصميم والألوان

### ألوان بطاقات الرصيد
- **سنوية**: خلفية `#EFF6FF`، حدود `#BFDBFE`، رقم `#2563EB`
- **مرضية**: خلفية `#FFF1F2`، حدود `#FECACA`، رقم `#DC2626`
- **طارئة**: خلفية `#FFFBEB`، حدود `#FDE68A`، رقم `#EA580C`

### ألوان الحالات
- **موافق عليها**: `#10B981` (أخضر)
- **قيد المراجعة**: `#F59E0B` (أصفر)
- **مرفوضة**: `#EF4444` (أحمر)

### الأيقونات
- رصيد الإجازات: `Icons.calendar_month_rounded`
- النموذج الموحد: `Icons.assignment_turned_in_rounded`
- تاريخ الإجازات: `Icons.history_rounded`
- تاريخ الاستئذانات: `Icons.access_time_rounded`

## التحققات والقيود

### طلب الإجازة
- النوع والتاريخان إلزاميان
- تاريخ النهاية يجب أن يكون بعد تاريخ البداية
- السبب إلزامي

### طلب الاستئذان
- النوع والتاريخ والوقت إلزامية
- وقت النهاية يجب أن يكون بعد وقت البداية
- الحد الأقصى للاستئذان: 4 ساعات
- السبب إلزامي

## التكامل مع النظام

### التوجيه
تم إضافة مسار `/leave` في `lib/router.dart` للوصول إلى شاشة نظام الإجازات.

### الشاشة الرئيسية
تم تحديث رابط "طلب إجازة" في الشاشة الرئيسية ليشير إلى النظام الجديد.

## الاستخدام

```dart
// الانتقال إلى شاشة نظام الإجازات
context.go('/leave');
```

## التطوير المستقبلي

### TODO Items
1. ربط النظام بـ API حقيقي
2. إضافة مرفقات طبية لطلبات الإجازات المرضية
3. إضافة إشعارات للطلبات الجديدة
4. إضافة تقارير وإحصائيات
5. دعم الموافقة/الرفض من قبل المديرين

### نقاط التوسع
- إضافة أنواع إجازات جديدة
- تخصيص حدود الاستئذان حسب السياسات
- إضافة نظام تصديق متعدد المستويات
- دعم الإجازات الجماعية

## الاختبار

النظام جاهز للاختبار مع البيانات الوهمية المدمجة. يمكن اختبار:
- عرض رصيد الإجازات
- إرسال طلبات إجازة واستئذان
- عرض تاريخ الطلبات
- التحققات والرسائل

## الدعم التقني

النظام يستخدم:
- Flutter SDK
- flutter_bloc لإدارة الحالة
- google_fonts للخطوط العربية
- Material 3 للتصميم
- دعم كامل لـ RTL
